# Crypto Arbitrage Scanner

Проект обновлён до архитектуры **арбитражного бота** с поддержкой:
- **CoinCap** как источника универсума монет (какие активы сканировать),
- **CEX** (MEXC, Bybit, Bitget + любые другие через `ccxt`),
- **DEX** (через агрегатор DexScreener),
- **P2P RUB** (поиск рублёвых связок через Bybit P2P).

## Что было оптимизировано

1. **Архитектура разделена на модули**: источники котировок (`CEX`, `DEX`, `P2P`) и единый движок поиска связок.
2. **Единая модель данных котировки** (`Quote`) и возможности (`Opportunity`) — проще добавлять новые биржи.
3. **Фильтрация рынка через CoinCap** — меньше лишних запросов к биржам.
4. **Учет комиссий и проскальзывания** в движке (`taker_fee_percent`, `slippage_percent`) вместо «сырого» спреда.
5. **Конфигурируемость**: все ключевые параметры вынесены в `config.bot.json`.
6. **Результаты сохраняются в JSON** в `data/trades/opportunities_latest.json` для последующей автоматизации/алертов.

## Быстрый старт

1. Установить зависимости:
   ```bash
   pip install -r requirements.txt
   ```
2. Проверить/изменить конфиг:
   - `config.bot.json`
3. Запустить один проход сканирования:
   ```bash
   python arbitrage_bot.py --config config.bot.json --once
   ```
4. Запустить в цикле:
   ```bash
   python arbitrage_bot.py --config config.bot.json
   ```

## Где реализована логика

- `arbitrage_bot.py` — основной бот.
- `tests/unit/test_arbitrage_engine.py` — unit-тесты движка поиска связок.

## Следующие шаги (рекомендую)

1. Добавить **прямые P2P-адаптеры MEXC и Bitget** (сейчас RUB реализован для Bybit).
2. Добавить **оценку сетевых комиссий и времени вывода** по сетям (TRC20/ERC20/BEP20).
3. Подключить **реальные стаканы (`fetch_order_book`)** вместо только top-of-book.
4. Добавить **Telegram-алерты** и риск-модуль (`max daily loss`, cooldown).
5. Для HFT-режима перейти на **WebSocket** для бирж, где это доступно.
